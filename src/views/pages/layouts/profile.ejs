<html>

<head>
    <%- include ../includes/_head%>
</head>

<body>
    <form id = "app" @submit="CheckForm" method="POST" novalidate="true">
        <%- include('../includes/_header')%>
        <div id="" class="align-items-start mt-5 justify-content-center d-flex flip-card-3D-wrapper">
            <img class="logo" src="/public/images/logo.png" alt="">
            <div id="flip-card" >
                
                <div class="flip-card-front pb-3">
                    <div class="mt-5">
                        <img :src="loginUser.icon_url"
                            height="100px;" width="100px;" class="rounded-circle mr-2" alt="">
                    </div>
                    <div class="mb-3">
                        <div>
                            <p class="text-light m-0">Name</p>
                            <input id="name" type="text" v-model="loginUser.name">
                        </div>
                        <div>
                            <p class="text-light m-0">Email</p>
                            <input id="email" type="email" v-model="loginUser.email">
                            <div v-if="error != '' " class="error-text m-0">{{ error }}</div>
                        </div>
                        <div>
                            <p class="text-light m-0">Phone</p>
                            <input id="phone" type="text" v-model="loginUser.phone">
                        </div>
                        <div>
                            <p class="text-light m-0">Nick_name</p>
                            <input id="nick_name" type="text" v-model="loginUser.nick_name">
                        </div>
                    </div>
                    <div class="input-group d-flex justify-content-center my-3">
                        <input class="mx-2 btn-success btn" type="submit" value="Save">
                        <a class="mx-2 btn-light btn" href="/home">Cancel</a>
                    </div>
                </div>
            </div>
        </div>
        <%- include ../includes/_footer%>
    </form>
</body>

<style>
    body {
        background-image: url(https://images.pexels.com/photos/952670/pexels-photo-952670.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260);
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
        background-size: cover;
    }

    @import url('https://fonts.googleapis.com/css?family=Open+Sans:300,600');

    html,
    body {
        /* height: 100vh; */
        /* width: 100%; */
        background: ivory;
        /* overflow: hidden; */
        font-family: 'Open Sans', sans-serif;
        background-image: url(https://images.pexels.com/photos/129208/pexels-photo-129208.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260);
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
        background-size: cover;
        color: #F0F8FF;
    }

    .logo {
        z-index: 10000;
        position: absolute;
        top: -50;
        right: -50;
        width: 52%;
        height: 47%;
    }

    .form-control {
        width: inherit;
    }

    html * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    *,
    *:after,
    *:before {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }


    .flip-card-3D-wrapper {
        width: 60%;
        height: 50%;
        max-width: 320px;
        min-width: 220px;
        position: relative;
        -o-perspective: 900px;
        -webkit-perspective: 900px;
        -ms-perspective: 900px;
        perspective: 900px;
        margin: 0 auto;
    }

    #flip-card {
        width: 100%;
        height: 100%;
        text-align: center;
        margin: 50px auto;        
        position: absolute;
    }


    #flip-card .flip-card-front,
    #flip-card .flip-card-back {
        width: 100%;
        -o-backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
        -ms-backface-visibility: hidden;
        backface-visibility: hidden;
        z-index: 2;
        -webkit-box-shadow: 2px 3px 32px 1px rgba(133, 133, 133, 0.71);
        -moz-box-shadow: 2px 3px 32px 1px rgba(133, 133, 133, 0.71);
        box-shadow: 2px 3px 32px 1px rgba(133, 133, 133, 0.71);
    }
    .flip-card-front{
        padding-bottom:5%;
    }

    #flip-card .flip-card-front {
        background: #747372;
        border-top: 5px solid #7A1737;
    }

    #flip-card .flip-card-back {
        background: #747372;
        border-top: 5px solid #7A1737;

    }

    .flip-card-back,
    .flip-card-front {
        border-radius: 20px;
    }

    #flip-card .flip-card-front p,
    #flip-card .flip-card-back p {
        color: grey;
        display: block;
        width: 100%;
    }

    #flip-card .flip-card-front .error-text,
    #flip-card .flip-card-back .error-text{
        color: #7A1737;
    }
</style>

<script>
    var vm = new Vue({
        el: '#app',
        name: 'mfgActivity',
        data: {
            title: 'Kanban',
            error: '',
            board: {
                name: 'Kanban'
            },
            loginUser: {},
            boardTitle:'',
            isEditBoardTitle: false
        },

        watch: {

        },
        methods: {
            SaveUserProfile: function () {
                const {board_list, ...info} = this.loginUser
                $.ajax({
                    type: 'POST',
                    url: '/saveUserInfo',
                    data: info,
                    success: response => {
                        console.log(response);
                    },
                    error: function (xhr, textStatus, error) {
                        console.log(error);
                    }
                });
            },
            CheckForm: function (e) {
                this.error = '';

                if (!this.loginUser.email) {
                    console.log("check form no email");
                    this.error = 'Email required';
                } 
                else if (!this.ValidEmail(this.loginUser.email)) {
                    console.log("check form email error");
                    this.error = 'Valid email required.';
                }

                if (this.error == '') {
                    console.log("check form no error");
                    this.SaveUserProfile();
                }

                e.preventDefault();

            },
            ValidEmail: function (email) {
                var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            },
            EditBoardTitle: function() {

            },
            CancelEditBoardTitle: function() {

            },
            DoneEditBoardTitle: function() {
                
            }
        },

        mounted() {
            $.ajax({
                type: 'GET',
                url: '/userInfo',
                success: user => {
                    this.loginUser = user;
                },
                error: function (xhr, textStatus, error) {
                    console.log(error);
                }
            });
        }
})
</script>

</html>