<html>

<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <link rel="stylesheet" href="/public/stylesheet/button_style.css">

    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <%- include ../includes/_head%>

</head>

<body>
    <form id = "app" @submit="CheckForm" method="POST" novalidate="true">
        <%- include('../includes/_header',{title:'{{ title }}',name:'{{ userInfo.name }}'})%>
        <div id="" class="align-items-start mt-5 justify-content-center d-flex flip-card-3D-wrapper">
            <img class="logo" src="/public/images/logo.png" alt="">
            <div id="flip-card" >
                
                <div class="flip-card-front pb-3">
                    <div class="mt-5">
                        <img :src="userInfo.icon_url"
                            height="100px;" width="100px;" class="rounded-circle mr-2" alt="">
                    </div>
                    <div v-if="error != '' ">
                        <p class="text-black m-0">{{ error }}</p>
                    </div>
                    <div class="mb-3">
                        <p class="text-light m-0">Name</p>
                        <input id="name" type="text" v-model="userInfo.name">
                        <p class="text-light m-0">Email</p>
                        <input id="email" type="email" v-model="userInfo.email">
                        <p class="text-light m-0">Phone</p>
                        <input id="phone" type="text" v-model="userInfo.phone">
                        <p class="text-light m-0">Nick_name</p>
                        <input id="nick_name" type="text" v-model="userInfo.nick_name">
                    </div>
                    <div class="input-group d-flex justify-content-center my-3">
                        <input class="mx-2 btn-success btn" type="submit" value="Save">
                        <a class="mx-2 btn-light btn" href="/home">Cancel</a>
                    </div>
                </div>
            </div>
        </div>
    </form>
</body>



<style>
    body {
        background-image: url(https://images.pexels.com/photos/952670/pexels-photo-952670.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260);
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
        background-size: cover;

    }

    @import url('https://fonts.googleapis.com/css?family=Open+Sans:300,600');

    html,
    body {
        /* height: 100vh; */
        /* width: 100%; */
        background: ivory;
        /* overflow: hidden; */
        font-family: 'Open Sans', sans-serif;
        background-image: url(https://images.pexels.com/photos/129208/pexels-photo-129208.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260);
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
        background-size: cover;
        color: #F0F8FF;
    }

    .logo {
        z-index: 10000;
        position: absolute;
        top: -50;
        right: -50;
        width: 52%;
        height: 47%;
    }

    .form-control {
        width: inherit;
    }

    html * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    *,
    *:after,
    *:before {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }


    .flip-card-3D-wrapper {
        width: 60%;
        height: 50%;
        max-width: 320px;
        min-width: 220px;
        position: relative;
        -o-perspective: 900px;
        -webkit-perspective: 900px;
        -ms-perspective: 900px;
        perspective: 900px;
        margin: 0 auto;
    }

    #flip-card {
        width: 100%;
        height: 100%;
        text-align: center;
        margin: 50px auto;        
        position: absolute;
    }


    #flip-card .flip-card-front,
    #flip-card .flip-card-back {
        width: 100%;
        -o-backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
        -ms-backface-visibility: hidden;
        backface-visibility: hidden;
        z-index: 2;
        -webkit-box-shadow: 2px 3px 32px 1px rgba(133, 133, 133, 0.71);
        -moz-box-shadow: 2px 3px 32px 1px rgba(133, 133, 133, 0.71);
        box-shadow: 2px 3px 32px 1px rgba(133, 133, 133, 0.71);
    }
    .flip-card-front{
        padding-bottom:5%;
    }

    #flip-card .flip-card-front {
        background: #747372;
        border-top: 5px solid #7A1737;
    }

    #flip-card .flip-card-back {
        background: #747372;
        border-top: 5px solid #7A1737;

    }

    .flip-card-back,
    .flip-card-front {
        border-radius: 20px;
    }

    #flip-card .flip-card-front p,
    #flip-card .flip-card-back p {
        color: grey;
        display: block;
        width: 100%;
    }

    #flip-card .flip-card-front .text-black,
    #flip-card .flip-card-back .text-black{
        color: black;
    }
</style>

<script>
    var vm = new Vue({
        el: '#app',
        name: 'mfgActivity',
        data: {
            title: 'Kanban',
            error: '',
            userInfo: {
                id: '',
                name: '',
                email: '',
                password: '',
                phone: '',
                nick_name: '',
                icon_url: '',
                board_list: []
            }
        },

        watch: {

        },
        methods: {
            SaveUserProfile: function () {
                const {board_list, ...info} = this.userInfo
                $.ajax({
                    type: 'POST',
                    url: '/saveUserInfo',
                    data: info,
                    success: response => {
                        console.log(response);
                    },
                    error: function (xhr, textStatus, error) {
                        console.log(error);
                    }
                });
            },
            CheckForm: function (e) {
                this.error = '';

                if (!this.userInfo.email) {
                    console.log("check form no email");
                    this.error = 'Email required';
                } 
                else if (!this.ValidEmail(this.userInfo.email)) {
                    console.log("check form email error");
                    this.error = 'Valid email required.';
                }

                if (this.error == '') {
                    console.log("check form no error");
                    this.SaveUserProfile();
                }

                e.preventDefault();

            },

            ValidEmail: function (email) {
                var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            },
        },

        mounted() {
            $.ajax({
                type: 'GET',
                url: '/userInfo',
                success: userInfo => {
                    this.userInfo = userInfo
                },
                error: function (xhr, textStatus, error) {
                    console.log(error);
                }
            });
        }
})
</script>

</html>